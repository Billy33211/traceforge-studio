<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TraceForge Studio ‚Äî By Otaku</title>
<link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;400;600;700&family=Noto+Serif+JP:wght@300;400;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
  :root {
    --ink: #0a0a0f;
    --paper: #f5f0e8;
    --red: #c0392b;
    --red-bright: #e74c3c;
    --gold: #d4a843;
    --muted: #8a8070;
    --line: rgba(10,10,15,0.12);
    --white: #ffffff;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--paper);
    color: var(--ink);
    font-family: 'Rajdhani', sans-serif;
    overflow-x: hidden;
  }

  /* ‚îÄ‚îÄ NOISE TEXTURE OVERLAY ‚îÄ‚îÄ */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 9999;
    opacity: 0.4;
  }

  /* ‚îÄ‚îÄ HERO ‚îÄ‚îÄ */
  .hero {
    min-height: 100vh;
    display: grid;
    grid-template-columns: 1fr 1fr;
    position: relative;
    overflow: hidden;
  }

  .hero-left {
    background: var(--ink);
    padding: 60px 50px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    position: relative;
    overflow: hidden;
  }

  /* manga panel lines */
  .hero-left::before {
    content: '';
    position: absolute;
    inset: 0;
    background: repeating-linear-gradient(
      -55deg,
      transparent,
      transparent 18px,
      rgba(255,255,255,0.02) 18px,
      rgba(255,255,255,0.02) 19px
    );
  }

  /* speed lines */
  .speed-lines {
    position: absolute;
    right: -20px;
    top: 50%;
    transform: translateY(-50%);
    width: 120px;
    height: 400px;
    overflow: hidden;
  }
  .speed-lines span {
    position: absolute;
    left: 0;
    width: 100%;
    height: 2px;
    background: linear-gradient(to right, transparent, rgba(192,57,43,0.6));
    transform-origin: left center;
  }
  .speed-lines span:nth-child(1) { top: 5%; transform: rotate(-12deg); }
  .speed-lines span:nth-child(2) { top: 15%; transform: rotate(-8deg); height: 1px; }
  .speed-lines span:nth-child(3) { top: 25%; transform: rotate(-5deg); }
  .speed-lines span:nth-child(4) { top: 35%; transform: rotate(-2deg); height: 3px; }
  .speed-lines span:nth-child(5) { top: 45%; transform: rotate(0deg); height: 4px; background: linear-gradient(to right, transparent, rgba(192,57,43,0.9)); }
  .speed-lines span:nth-child(6) { top: 55%; transform: rotate(2deg); height: 3px; }
  .speed-lines span:nth-child(7) { top: 65%; transform: rotate(5deg); }
  .speed-lines span:nth-child(8) { top: 75%; transform: rotate(8deg); height: 1px; }
  .speed-lines span:nth-child(9) { top: 85%; transform: rotate(12deg); }

  .tag {
    font-family: 'Space Mono', monospace;
    font-size: 10px;
    letter-spacing: 4px;
    color: var(--red);
    text-transform: uppercase;
    margin-bottom: 20px;
    animation: fadeUp 0.8s ease both;
  }

  .hero-title {
    font-family: 'Noto Serif JP', serif;
    font-size: clamp(42px, 6vw, 72px);
    font-weight: 700;
    color: var(--white);
    line-height: 1;
    margin-bottom: 8px;
    animation: fadeUp 0.8s 0.1s ease both;
  }

  .hero-title span {
    color: var(--red);
    display: block;
  }

  .hero-sub {
    font-family: 'Space Mono', monospace;
    font-size: 11px;
    color: var(--muted);
    letter-spacing: 2px;
    margin-bottom: 36px;
    animation: fadeUp 0.8s 0.2s ease both;
  }

  .hero-desc {
    font-size: 17px;
    line-height: 1.65;
    color: rgba(245,240,232,0.75);
    max-width: 420px;
    margin-bottom: 44px;
    font-weight: 300;
    animation: fadeUp 0.8s 0.3s ease both;
  }

  .btn-group {
    display: flex;
    gap: 14px;
    flex-wrap: wrap;
    animation: fadeUp 0.8s 0.4s ease both;
  }

  .btn {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    padding: 14px 28px;
    font-family: 'Rajdhani', sans-serif;
    font-size: 15px;
    font-weight: 700;
    letter-spacing: 2px;
    text-transform: uppercase;
    text-decoration: none;
    cursor: pointer;
    border: none;
    transition: all 0.2s ease;
    position: relative;
    overflow: hidden;
  }

  .btn-primary {
    background: var(--red);
    color: var(--white);
    clip-path: polygon(0 0, calc(100% - 10px) 0, 100% 10px, 100% 100%, 10px 100%, 0 calc(100% - 10px));
  }
  .btn-primary:hover {
    background: var(--red-bright);
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(192,57,43,0.4);
  }

  .btn-outline {
    background: transparent;
    color: var(--paper);
    border: 1px solid rgba(245,240,232,0.3);
    clip-path: polygon(0 0, calc(100% - 10px) 0, 100% 10px, 100% 100%, 10px 100%, 0 calc(100% - 10px));
  }
  .btn-outline:hover {
    border-color: var(--gold);
    color: var(--gold);
    transform: translateY(-2px);
  }

  /* ‚îÄ‚îÄ HERO RIGHT ‚îÄ‚îÄ */
  .hero-right {
    background: var(--paper);
    padding: 60px 50px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    position: relative;
  }

  .manga-panel {
    border: 2px solid var(--ink);
    padding: 30px;
    position: relative;
    background: var(--white);
    box-shadow: 6px 6px 0 var(--ink);
    animation: fadeUp 0.8s 0.5s ease both;
  }
  .manga-panel::before {
    content: 'v6.0';
    position: absolute;
    top: -12px;
    right: 20px;
    background: var(--red);
    color: white;
    font-family: 'Space Mono', monospace;
    font-size: 11px;
    padding: 2px 10px;
    letter-spacing: 1px;
  }

  .panel-title {
    font-family: 'Noto Serif JP', serif;
    font-size: 13px;
    font-weight: 700;
    letter-spacing: 3px;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 20px;
    border-bottom: 1px solid var(--line);
    padding-bottom: 12px;
  }

  .feature-list {
    list-style: none;
    display: flex;
    flex-direction: column;
    gap: 14px;
  }

  .feature-list li {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    font-size: 16px;
    font-weight: 400;
    line-height: 1.4;
    color: var(--ink);
  }

  .feature-list li::before {
    content: '‚ñ∂';
    color: var(--red);
    font-size: 10px;
    margin-top: 4px;
    flex-shrink: 0;
  }

  .manga-divider {
    height: 4px;
    background: var(--ink);
    margin: 30px 0;
    position: relative;
    animation: fadeUp 0.8s 0.6s ease both;
  }
  .manga-divider::after {
    content: '‚óè';
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    background: var(--paper);
    padding: 0 8px;
    color: var(--red);
    font-size: 12px;
  }

  .version-badge {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    background: var(--ink);
    color: var(--gold);
    font-family: 'Space Mono', monospace;
    font-size: 12px;
    padding: 8px 16px;
    letter-spacing: 2px;
    margin-top: 20px;
    animation: fadeUp 0.8s 0.7s ease both;
  }

  /* ‚îÄ‚îÄ DOWNLOAD SECTION ‚îÄ‚îÄ */
  .download-section {
    background: var(--ink);
    padding: 80px 60px;
    position: relative;
    overflow: hidden;
  }

  .download-section::before {
    content: 'DOWNLOAD';
    position: absolute;
    right: -30px;
    top: 50%;
    transform: translateY(-50%) rotate(90deg);
    font-family: 'Noto Serif JP', serif;
    font-size: 120px;
    font-weight: 700;
    color: rgba(255,255,255,0.03);
    letter-spacing: -5px;
    pointer-events: none;
  }

  .section-header {
    margin-bottom: 50px;
  }

  .section-tag {
    font-family: 'Space Mono', monospace;
    font-size: 10px;
    letter-spacing: 4px;
    color: var(--red);
    text-transform: uppercase;
    margin-bottom: 12px;
    display: block;
  }

  .section-title {
    font-family: 'Noto Serif JP', serif;
    font-size: clamp(28px, 4vw, 48px);
    font-weight: 700;
    color: var(--white);
    line-height: 1.1;
  }

  .releases-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
    gap: 24px;
  }

  .release-card {
    border: 1px solid rgba(245,240,232,0.12);
    padding: 28px;
    position: relative;
    background: rgba(255,255,255,0.03);
    transition: all 0.25s ease;
    clip-path: polygon(0 0, calc(100% - 16px) 0, 100% 16px, 100% 100%, 0 100%);
  }

  .release-card:hover {
    border-color: var(--red);
    background: rgba(192,57,43,0.08);
    transform: translateY(-4px);
  }

  .release-card.latest {
    border-color: var(--gold);
    background: rgba(212,168,67,0.06);
  }

  .release-card.latest::before {
    content: 'LATEST';
    position: absolute;
    top: -1px;
    left: 20px;
    background: var(--gold);
    color: var(--ink);
    font-family: 'Space Mono', monospace;
    font-size: 9px;
    font-weight: 700;
    padding: 3px 10px;
    letter-spacing: 2px;
  }

  .release-version {
    font-family: 'Space Mono', monospace;
    font-size: 11px;
    color: var(--muted);
    letter-spacing: 2px;
    margin-bottom: 8px;
  }

  .release-name {
    font-family: 'Noto Serif JP', serif;
    font-size: 22px;
    color: var(--white);
    font-weight: 700;
    margin-bottom: 14px;
  }

  .release-notes {
    font-size: 14px;
    color: rgba(245,240,232,0.55);
    line-height: 1.6;
    margin-bottom: 24px;
  }

  .release-meta {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-bottom: 20px;
    font-family: 'Space Mono', monospace;
    font-size: 10px;
    color: var(--muted);
    letter-spacing: 1px;
  }

  .release-meta span {
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .btn-download {
    width: 100%;
    justify-content: center;
    background: var(--red);
    color: var(--white);
    font-family: 'Rajdhani', sans-serif;
    font-weight: 700;
    font-size: 14px;
    letter-spacing: 2px;
    text-transform: uppercase;
    padding: 12px 20px;
    border: none;
    cursor: pointer;
    text-decoration: none;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.2s;
    clip-path: polygon(0 0, calc(100% - 8px) 0, 100% 8px, 100% 100%, 8px 100%, 0 calc(100% - 8px));
  }

  .btn-download:hover {
    background: var(--red-bright);
    box-shadow: 0 6px 20px rgba(192,57,43,0.4);
  }

  .btn-download.disabled {
    background: rgba(255,255,255,0.08);
    color: var(--muted);
    cursor: not-allowed;
    pointer-events: none;
    clip-path: polygon(0 0, calc(100% - 8px) 0, 100% 8px, 100% 100%, 8px 100%, 0 calc(100% - 8px));
  }

  /* ‚îÄ‚îÄ ADMIN SECTION ‚îÄ‚îÄ */
  .admin-section {
    background: var(--paper);
    padding: 80px 60px;
    border-top: 4px solid var(--ink);
    position: relative;
  }

  .admin-section::before {
    content: '';
    position: absolute;
    top: 0; left: 0;
    width: 100%;
    height: 4px;
    background: repeating-linear-gradient(
      to right,
      var(--ink) 0px,
      var(--ink) 20px,
      var(--red) 20px,
      var(--red) 24px
    );
  }

  .admin-inner {
    max-width: 700px;
    margin: 0 auto;
  }

  .admin-locked {
    border: 2px solid var(--ink);
    padding: 40px;
    background: var(--white);
    box-shadow: 6px 6px 0 var(--ink);
    position: relative;
  }

  .admin-locked::before {
    content: 'ÁÆ°ÁêÜËÄÖ';
    position: absolute;
    top: -14px;
    left: 20px;
    background: var(--ink);
    color: var(--gold);
    font-family: 'Noto Serif JP', serif;
    font-size: 13px;
    padding: 2px 14px;
    letter-spacing: 2px;
  }

  .admin-title {
    font-family: 'Noto Serif JP', serif;
    font-size: 26px;
    font-weight: 700;
    margin-bottom: 8px;
  }

  .admin-desc {
    font-size: 15px;
    color: var(--muted);
    margin-bottom: 30px;
    line-height: 1.5;
  }

  .form-group {
    margin-bottom: 20px;
  }

  .form-group label {
    display: block;
    font-family: 'Space Mono', monospace;
    font-size: 10px;
    letter-spacing: 3px;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 8px;
  }

  .form-group input,
  .form-group textarea,
  .form-group select {
    width: 100%;
    border: 1px solid var(--ink);
    background: var(--paper);
    padding: 12px 16px;
    font-family: 'Rajdhani', sans-serif;
    font-size: 16px;
    color: var(--ink);
    outline: none;
    transition: border-color 0.2s;
  }

  .form-group input:focus,
  .form-group textarea:focus,
  .form-group select:focus {
    border-color: var(--red);
    box-shadow: 3px 3px 0 rgba(192,57,43,0.15);
  }

  .form-group textarea {
    height: 100px;
    resize: vertical;
  }

  .file-drop {
    border: 2px dashed var(--ink);
    padding: 36px;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s;
    background: var(--paper);
    position: relative;
  }

  .file-drop:hover, .file-drop.drag-over {
    border-color: var(--red);
    background: rgba(192,57,43,0.04);
  }

  .file-drop input[type="file"] {
    position: absolute;
    inset: 0;
    opacity: 0;
    cursor: pointer;
    width: 100%;
    height: 100%;
  }

  .file-drop-icon {
    font-size: 36px;
    margin-bottom: 10px;
  }

  .file-drop-text {
    font-size: 14px;
    color: var(--muted);
    font-family: 'Space Mono', monospace;
  }

  .file-drop-name {
    margin-top: 10px;
    font-weight: 700;
    color: var(--red);
    font-size: 14px;
  }

  /* password gate */
  .password-gate {
    display: flex;
    gap: 12px;
    margin-bottom: 28px;
  }
  .password-gate input {
    flex: 1;
    border: 1px solid var(--ink);
    background: var(--paper);
    padding: 12px 16px;
    font-family: 'Space Mono', monospace;
    font-size: 14px;
    letter-spacing: 3px;
    outline: none;
    color: var(--ink);
  }
  .password-gate input:focus { border-color: var(--red); }

  .admin-form { display: none; }
  .admin-form.visible { display: block; }

  .btn-admin {
    background: var(--ink);
    color: var(--white);
    border: none;
    padding: 12px 28px;
    font-family: 'Rajdhani', sans-serif;
    font-size: 15px;
    font-weight: 700;
    letter-spacing: 2px;
    text-transform: uppercase;
    cursor: pointer;
    transition: all 0.2s;
    clip-path: polygon(0 0, calc(100% - 8px) 0, 100% 8px, 100% 100%, 8px 100%, 0 calc(100% - 8px));
  }
  .btn-admin:hover {
    background: var(--red);
  }

  .btn-submit {
    width: 100%;
    background: var(--red);
    color: var(--white);
    border: none;
    padding: 16px;
    font-family: 'Rajdhani', sans-serif;
    font-size: 16px;
    font-weight: 700;
    letter-spacing: 3px;
    text-transform: uppercase;
    cursor: pointer;
    transition: all 0.2s;
    margin-top: 10px;
    clip-path: polygon(0 0, calc(100% - 10px) 0, 100% 10px, 100% 100%, 10px 100%, 0 calc(100% - 10px));
  }
  .btn-submit:hover {
    background: var(--red-bright);
    box-shadow: 0 6px 20px rgba(192,57,43,0.3);
  }

  .error-msg {
    color: var(--red);
    font-family: 'Space Mono', monospace;
    font-size: 11px;
    margin-top: 6px;
    display: none;
  }
  .error-msg.visible { display: block; }

  .success-msg {
    background: var(--ink);
    color: var(--gold);
    font-family: 'Space Mono', monospace;
    font-size: 12px;
    padding: 14px 20px;
    letter-spacing: 2px;
    margin-top: 16px;
    display: none;
  }
  .success-msg.visible { display: block; }

  /* ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ */
  footer {
    background: var(--ink);
    padding: 40px 60px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 16px;
    border-top: 2px solid var(--red);
  }

  .footer-brand {
    font-family: 'Noto Serif JP', serif;
    font-size: 18px;
    font-weight: 700;
    color: var(--white);
  }
  .footer-brand span { color: var(--red); }

  .footer-note {
    font-family: 'Space Mono', monospace;
    font-size: 10px;
    color: var(--muted);
    letter-spacing: 2px;
  }

  /* ‚îÄ‚îÄ ANIMATIONS ‚îÄ‚îÄ */
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(20px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  /* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
  @media (max-width: 768px) {
    .hero { grid-template-columns: 1fr; }
    .hero-left, .hero-right { padding: 40px 28px; }
    .download-section, .admin-section { padding: 60px 28px; }
    footer { padding: 30px 28px; flex-direction: column; text-align: center; }
    .speed-lines { display: none; }
  }

  /* notification */
  .toast {
    position: fixed;
    bottom: 30px;
    right: 30px;
    background: var(--ink);
    color: var(--gold);
    font-family: 'Space Mono', monospace;
    font-size: 12px;
    padding: 14px 22px;
    z-index: 10000;
    transform: translateY(80px);
    opacity: 0;
    transition: all 0.3s ease;
    clip-path: polygon(0 0, calc(100% - 8px) 0, 100% 8px, 100% 100%, 8px 100%, 0 calc(100% - 8px));
    pointer-events: none;
  }
  .toast.show {
    transform: translateY(0);
    opacity: 1;
  }
</style>
</head>
<body>

<!-- ‚ïê‚ïê HERO ‚ïê‚ïê -->
<section class="hero">
  <div class="hero-left">
    <div class="speed-lines">
      <span></span><span></span><span></span><span></span><span></span>
      <span></span><span></span><span></span><span></span>
    </div>
    <div class="tag">// Krita Plugin ¬∑ Anime Tools</div>
    <h1 class="hero-title">
      TraceForge<span>Studio</span>
    </h1>
    <p class="hero-sub">By Otaku &nbsp;¬∑&nbsp; Free ¬∑ Open</p>
    <p class="hero-desc">
      Transform your reference images into professional anime-style line art, colour guides, and construction steps ‚Äî right inside Krita. Built for artists, by an artist.
    </p>
    <div class="btn-group">
      <a href="#download" class="btn btn-primary">
        ‚Üì &nbsp;Download Now
      </a>
      <a href="#admin" class="btn btn-outline">
        ‚Üë &nbsp;Upload Update
      </a>
    </div>
  </div>

  <div class="hero-right">
    <div class="manga-panel">
      <div class="panel-title">What's Inside</div>
      <ul class="feature-list">
        <li>Original image viewer ‚Äî unmodified source at full quality</li>
        <li>Line Art tab ‚Äî pencil sketch generator with edge detection</li>
        <li>Colour Guide ‚Äî overlay + palette strip extraction</li>
        <li>Colour Map ‚Äî flat colour zones with hex labels per region</li>
        <li>Trace Steps ‚Äî anatomy-driven construction layers (head ‚Üí jaw ‚Üí eyes ‚Üí hair‚Ä¶)</li>
        <li>All processing is threaded ‚Äî no UI freeze</li>
        <li>Auto-installs dependencies (Pillow, NumPy, OpenCV)</li>
      </ul>
    </div>

    <div class="manga-divider"></div>

    <div class="version-badge">
      ‚óÜ &nbsp;CURRENT RELEASE: v6.0 &nbsp;¬∑&nbsp; Python 3 &nbsp;¬∑&nbsp; Krita 5+
    </div>
  </div>
</section>


<!-- ‚ïê‚ïê DOWNLOAD ‚ïê‚ïê -->
<section class="download-section" id="download">
  <div class="section-header">
    <span class="section-tag">// 01 ‚Äî Releases</span>
    <h2 class="section-title">Get TraceForge Studio</h2>
  </div>

  <div class="releases-grid" id="releasesGrid">
    <!-- Cards injected by JS -->
  </div>
</section>


<!-- ‚ïê‚ïê ADMIN UPLOAD ‚ïê‚ïê -->
<section class="admin-section" id="admin">
  <div class="admin-inner">
    <div class="section-header">
      <span class="section-tag">// 02 ‚Äî Developer Upload</span>
      <h2 class="section-title" style="color:var(--ink)">Push a New Release</h2>
    </div>

    <div class="admin-locked">
      <!-- PASSWORD GATE -->
      <div id="passwordGate">
        <p class="admin-desc">Enter your admin password to unlock the upload panel.</p>
        <div class="password-gate">
          <input type="password" id="adminPass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
          <button class="btn-admin" onclick="unlockAdmin()">Unlock</button>
        </div>
        <div class="error-msg" id="passError">Incorrect password. Try again.</div>
      </div>

      <!-- UPLOAD FORM (hidden until unlocked) -->
      <div class="admin-form" id="adminForm">
        <div class="admin-title">Upload New Version</div>
        <p class="admin-desc">Fill in the release details and attach the updated <code>.py</code> file. The new release will appear at the top of the download list.</p>

        <div class="form-group">
          <label>Version Number</label>
          <input type="text" id="newVersion" placeholder="e.g. v7.0" />
        </div>

        <div class="form-group">
          <label>Release Name</label>
          <input type="text" id="newName" placeholder="e.g. TraceForge Studio By Otaku" />
        </div>

        <div class="form-group">
          <label>Release Notes</label>
          <textarea id="newNotes" placeholder="What changed in this version?"></textarea>
        </div>

        <div class="form-group">
          <label>Attach File (.py)</label>
          <div class="file-drop" id="fileDrop">
            <input type="file" id="fileInput" accept=".py,.zip" onchange="handleFile(this)" />
            <div class="file-drop-icon">üì¶</div>
            <div class="file-drop-text">Drop .py or .zip here, or click to browse</div>
            <div class="file-drop-name" id="fileName"></div>
          </div>
        </div>

        <button class="btn-submit" onclick="addRelease()">Publish Release ‚ñ∂</button>
        <div class="success-msg" id="successMsg">‚úì &nbsp;Release published successfully!</div>
      </div>
    </div>
  </div>
</section>


<!-- ‚ïê‚ïê FOOTER ‚ïê‚ïê -->
<footer>
  <div class="footer-brand">TraceForge<span>Studio</span></div>
  <div class="footer-note">Made with ‚ù§ by Otaku ¬∑ Free for all artists</div>
</footer>

<div class="toast" id="toast"></div>

<script>
  // ‚îÄ‚îÄ ADMIN PASSWORD (change this!) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  const ADMIN_PASSWORD = 'otaku2024';

  // ‚îÄ‚îÄ RELEASES DATA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  // To pre-load the current file: update this array.
  // New releases added through the form are stored in sessionStorage for demo.
  const DEFAULT_RELEASES = [
    {
      version: 'v6.0',
      name: 'TraceForge Studio By Otaku',
      notes: 'Full rewrite. Adds Colour Map tab with hex region labels, anatomy-based Trace Steps (head ‚Üí jaw ‚Üí neck ‚Üí eye guides ‚Üí nose/mouth ‚Üí hair), threaded processing, and auto-dependency install. Paint tab removed.',
      date: '2025-06-01',
      size: '~38 KB',
      file: 'TraceForge_Studio_By_Otaku.py',
      latest: true,
      downloadUrl: 'TraceForge_Studio_By_Otaku.py'
    }
  ];

  // ‚îÄ‚îÄ RENDER RELEASES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  function getReleases() {
    const stored = sessionStorage.getItem('tf_releases');
    return stored ? JSON.parse(stored) : DEFAULT_RELEASES;
  }

  function saveReleases(arr) {
    sessionStorage.setItem('tf_releases', JSON.stringify(arr));
  }

  function renderReleases() {
    const grid = document.getElementById('releasesGrid');
    const releases = getReleases();
    grid.innerHTML = '';

    releases.forEach((r, i) => {
      const card = document.createElement('div');
      card.className = 'release-card' + (r.latest ? ' latest' : '');

      const downloadEl = r.blob
        ? `<a class="btn-download" href="${r.blob}" download="${r.file}">‚Üì &nbsp;Download ${r.version}</a>`
        : (r.downloadUrl
            ? `<a class="btn-download" href="${r.downloadUrl}" download="${r.file}">‚Üì &nbsp;Download ${r.version}</a>`
            : `<button class="btn-download disabled">File not attached</button>`);

      card.innerHTML = `
        <div class="release-version">${r.version}</div>
        <div class="release-name">${r.name}</div>
        <p class="release-notes">${r.notes}</p>
        <div class="release-meta">
          <span>üìÖ ${r.date}</span>
          <span>üíæ ${r.size}</span>
        </div>
        ${downloadEl}
      `;
      grid.appendChild(card);
    });
  }

  renderReleases();

  // ‚îÄ‚îÄ ADMIN UNLOCK ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  function unlockAdmin() {
    const val = document.getElementById('adminPass').value;
    if (val === ADMIN_PASSWORD) {
      document.getElementById('passwordGate').style.display = 'none';
      document.getElementById('adminForm').classList.add('visible');
    } else {
      document.getElementById('passError').classList.add('visible');
    }
  }

  document.getElementById('adminPass').addEventListener('keydown', e => {
    if (e.key === 'Enter') unlockAdmin();
  });

  // ‚îÄ‚îÄ FILE HANDLING ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  let selectedFile = null;

  function handleFile(input) {
    if (input.files && input.files[0]) {
      selectedFile = input.files[0];
      document.getElementById('fileName').textContent = '‚úì  ' + selectedFile.name;
    }
  }

  const drop = document.getElementById('fileDrop');
  drop.addEventListener('dragover', e => { e.preventDefault(); drop.classList.add('drag-over'); });
  drop.addEventListener('dragleave', () => drop.classList.remove('drag-over'));
  drop.addEventListener('drop', e => {
    e.preventDefault();
    drop.classList.remove('drag-over');
    const files = e.dataTransfer.files;
    if (files.length) {
      selectedFile = files[0];
      document.getElementById('fileName').textContent = '‚úì  ' + selectedFile.name;
    }
  });

  // ‚îÄ‚îÄ ADD RELEASE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  function addRelease() {
    const version = document.getElementById('newVersion').value.trim();
    const name    = document.getElementById('newName').value.trim();
    const notes   = document.getElementById('newNotes').value.trim();

    if (!version || !name || !notes) {
      showToast('Please fill in all fields.');
      return;
    }

    const releases = getReleases().map(r => ({ ...r, latest: false }));

    const newRelease = {
      version,
      name,
      notes,
      date: new Date().toISOString().split('T')[0],
      size: selectedFile ? (selectedFile.size > 1024*1024
        ? (selectedFile.size / 1024 / 1024).toFixed(1) + ' MB'
        : Math.round(selectedFile.size / 1024) + ' KB') : 'N/A',
      file: selectedFile ? selectedFile.name : '',
      latest: true,
      blob: null
    };

    if (selectedFile) {
      const reader = new FileReader();
      reader.onload = e => {
        newRelease.blob = e.target.result;
        releases.unshift(newRelease);
        saveReleases(releases);
        renderReleases();
        document.getElementById('successMsg').classList.add('visible');
        showToast('‚úì Release published!');
        // reset form
        document.getElementById('newVersion').value = '';
        document.getElementById('newName').value = '';
        document.getElementById('newNotes').value = '';
        document.getElementById('fileName').textContent = '';
        selectedFile = null;
        setTimeout(() => document.getElementById('successMsg').classList.remove('visible'), 4000);
      };
      reader.readAsDataURL(selectedFile);
    } else {
      releases.unshift(newRelease);
      saveReleases(releases);
      renderReleases();
      document.getElementById('successMsg').classList.add('visible');
      showToast('‚úì Release published (no file attached).');
      setTimeout(() => document.getElementById('successMsg').classList.remove('visible'), 4000);
    }
  }

  // ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  function showToast(msg) {
    const t = document.getElementById('toast');
    t.textContent = msg;
    t.classList.add('show');
    setTimeout(() => t.classList.remove('show'), 3000);
  }

  // ‚îÄ‚îÄ SMOOTH SCROLL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  document.querySelectorAll('a[href^="#"]').forEach(a => {
    a.addEventListener('click', e => {
      e.preventDefault();
      document.querySelector(a.getAttribute('href'))?.scrollIntoView({ behavior: 'smooth' });
    });
  });
</script>
</body>
</html>
